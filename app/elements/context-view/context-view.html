<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../styles/shared-styles.html">

<dom-module id="context-view">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
      }
      paper-card{
        width: 100%;
        margin-bottom: 20px;
      }
      .templates{
        margin: 10px;
        box-shadow: 1px 1px 1px #EEE;
        width: 100%;
      }
      .templates, .templates div{
        box-sizing: border-box;
      }
      .templates .row{
        height: 80px;
      }
      .templates .row:first-child{
        height: 40px;
        line-height: 40px;
      }
      .templates .row > div {
        display: inline-block;
        width: 40%;
        float: left;
        vertical-align: top;
        padding: 10px;
        height: 99%;
        overflow: hidden;
      }
      .templates .row > div:first-child{
        font-weight: bold;
        width: 20%;
      }
      .cell{
        position: relative;
        background-color: rgba(64, 215, 47, 0.05);
        font-size: smaller;
      }
      paper-icon-button {
        display: block;
        text-align: center;
        color: var(--default-primary-color);
        position: absolute;
        top: -10px;
        right: -8px;
        width: 30px;
        height: 30px;
      }
      .temp-control{
        display: inline-block;
        width: 50%;
        float: left;
      }
      .tbl-header{
        font-weight: bold;
        padding: 5px;
        text-align: center;
      }
      .tbl-header:first-child{
        border-bottom: 1px solid #DDD;
        border-right: 1px solid #DDD;
      }
      .templates .row:first-child .tbl-header{
        border-bottom: 1px solid #DDD;
        border-right: 1px solid #DDD;
      }
      bridgeit-document-property-text-editor{
        min-height: 243px;
        min-width: 546px;
      }
    </style>

    To complete

  </template>
  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'context-view',

      ready: function(){
        //var _this = this;
        /**Starbucks coding, for update
         * bridgeit.io.documents.getDocument({id: 'temperatureSettings'}).then(function(doc){
          _this.temperatureSettingsDoc = doc;
          _this.currentTemp = doc.current;
          _this.thresholdTemp = doc.threshold;
          return bridgeit.io.documents.getDocument({id: 'templateMessages'}).then(function(doc){
            _this.templateMessagesDoc = doc;
          }).then(function(){
            _this.loaded = true;
          }).catch(function(error){
            _this.fire('bridgeit-error', {error: Error('Could not fetch template messages: ' + error)});
          });
        }).catch(function(error){
          _this.fire('bridgeit-error', {error: Error('Could not fetch temperature settings: ' + error)});
        });*/
        
      },

      observers: ['tempChanged(currentTemp,thresholdTemp)'],

      properties: {
        visible: {type: Boolean, notify: true},
        loaded: {type: Boolean, notify: true},
        templateMessagesDoc: {type: Object},
        currentDocumentProperty: {type: Object, notify: true},
        showEditTemplateDialog: {type: Boolean, computed: '_computeShowEditTemplateDialog(currentDocumentProperty)'}
      },

      tempChanged: function(){
        if( this.loaded && this.visible ){
          //var _this = this;
          /**
            this.fire('temp-changed', {currentTemp: currentTemp, thresholdTemp: thresholdTemp});

          bridgeit.io.documents.updateDocument({
            id: this.temperatureSettingsDoc._id, 
            document: this.temperatureSettingsDoc
          }).catch(function(error){
            _this.fire('bridgeit-error', {error: Error('Temperature update failed: ' + error)});
          });
           */
        }
      },

      editTemplateMaleHot: function(){
        console.log('editTemplateMaleHot');
        this.currentDocumentProperty = 'hotMale';
      },

      editTemplateMaleCold: function(){
        console.log('editTemplateMaleCold');
        this.currentDocumentProperty = 'coldMale';
      },

      editTemplateFemaleHot: function(){
        console.log('editTemplateFemaleHot');
        this.currentDocumentProperty = 'hotFemale';
      },

      editTemplateFemaleCold: function(){
        console.log('editTemplateFemaleCold');
        this.currentDocumentProperty = 'coldFemale';
      },

      closeEditTemplateDialog: function(){
        this.currentDocumentProperty = null;
      },

      _computeShowEditTemplateDialog: function(currentDocumentProperty){
        return !!currentDocumentProperty;
      }
    });
  })();
  </script>
</dom-module>
